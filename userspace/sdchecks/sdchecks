#!/usr/bin/env python2
import site
import sys
import os.path

install_prefix = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))

# Get python version
python_version = "%d.%d" % sys.version_info[:2]

# Add our path, before system ones to avoid collisions
bin_deps_dir = install_prefix + '/lib/python-deps%s' % python_version
sys.path.insert(0, install_prefix + '/lib/python')

if python_version == "2.6":
    sys.path.insert(1, bin_deps_dir)
else:
    sys.path.insert(1, install_prefix + '/lib/python-deps')
    sys.path.insert(2, bin_deps_dir)

# Add site dirs so .pth files are evaluated
site.addsitedir(install_prefix + '/lib/python-deps')
site.addsitedir(bin_deps_dir)

# Run our app
from sdchecks import Application

if __name__ == "__main__":
    app = Application(install_prefix)
    try:
        app.main()
    except KeyboardInterrupt:
        pass
    finally:
        app.cleanup()
