#
# WARNING: Sysdig Cloud Agent default configuration, don't edit. Please use "dragent.yaml" instead
#
jmx:
  default_beans:
    - query: "java.lang:type=Memory"
      attributes:
        - HeapMemoryUsage
        - NonHeapMemoryUsage
    - query: "java.lang:type=GarbageCollector,*"
      attributes:
        - name: CollectionCount
          type: counter
        - name: CollectionTime
          type: counter
    - query: "java.lang:type=ClassLoading"
      attributes:
        - LoadedClassCount
        - UnloadedClassCount
    - query: "java.lang:type=Threading"
      attributes:
        - ThreadCount
        - DaemonThreadCount
  per_process_beans:
    cassandra:
      pattern: "cassandra"
      beans:
        - query: "org.apache.cassandra.db:type=StorageProxy"
          attributes:
            - RecentWriteLatencyMicros
            - RecentReadLatencyMicros
            - name: WriteOperations
              type: counter
            - name: ReadOperations
              type: counter
        - query: "org.apache.cassandra.db:type=CompactionManager"
          attributes:
            - name: TotalCompactionsCompleted
              type: counter
            - name: TotalBytesCompleted
              type: counter
            - PendingTasks
            - name: CompletedTasks
              type: counter
        - query: "org.apache.cassandra.db:type=Caches"
          attributes:
            - name: KeyCacheHits
              type: counter
            - name: KeyCacheRequests
              type: counter
            - name: RowCacheHits
              type: counter
            - name: RowCacheRequests
              type: counter
    tomcat:
      pattern: "catalina"
      beans:
        - query: "Catalina:type=Cache,*"
          attributes:
            - name: accessCount
              alias: tomcat.access.count
              type: counter
            - name: hitsCount
              alias: tomcat.hits.count
              type: counter
        - query: "Catalina:type=GlobalRequestProcessor,*"
          attributes:
            - name: bytesReceived
              alias: tomcat.bytes.received
              type: counter
            - name: errorCount
              alias: tomcat.error.count
              type: counter
            - name: maxTime
              alias: tomcat.max.time
            - name: requestCount
              alias: tomcat.request.count
              type: counter
            - name: processingTime
              alias: tomcat.processing.time
              type: counter
              unit: ms
            - name: bytesSent
              alias: tomcat.bytes.sent
              type: counter
        - query: "Catalina:type=Manager,*"
          attributes:
            - name: activeSessions
              alias: tomcat.sessions.active
              type: counter
            - name: maxActive
              alias: tomcat.session.max.active
            - name: expiredSessions
              alias: tomcat.sessions.expired
              type: counter
            - name: sessionCreateRate
              alias: tomcat.session.create.rate
            - name: sessionExpireRate
              alias: tomcat.session.expire.rate
        - query: "Catalina:type=ThreadPool,*"
          attributes:
            - name: maxThreads
              alias: tomcat.threads.max
            - name: currentThreadCount
              alias: tomcat.thread.current.count
            - name: currentThreadsBusy
              alias: tomcat.threads.current.busy
        - query: "Catalina:type=JspMonitor,*"
          attributes:
            - name: jspCount
              alias: tomcat.jsp.count
              type: counter
            - name: jspReloadCount
              alias: tomcat.jsp.reload.count
              type: counter
        - query: "Catalina:j2eeType=Servlet,*"
          attributes:
            - name: processingTime
              alias: tomcat.servlet.processing.time
              type: counter
            - name: errorCount
              alias: tomcat.servlet.error.count
              type: counter
            - name: requestCount
              alias: tomcat.servlet.request.count
              type: counter
        - query: "Catalina:type=DataSource,*"
          attributes:
            - name: numActive
              alias: tomcat.datasource.connection.active
              type: counter
            - name: numIdle
              alias: tomcat.datasource.connection.idle
              type: counter
            - name: maxActive
              alias: tomcat.datasource.connection.max.active
            - name: maxIdle
              alias: tomcat.datasource.connection.max.idle
            - name: minIdle
              alias: tomcat.datasource.connection.min.idle
    activemq:
      pattern: "activemq"
      beans:
        - query: "org.apache.activemq:Type=Broker,*"
          attributes:
            - TotalConsumerCount
            - TotalDequeueCount
            - TotalEnqueueCount
            - TotalMessageCount
            - TotalProducerCount
        - query: "org.apache.activemq:Type=Queue,*"
          attributes:
            - ConsumerCount
            - AverageEnqueueTime
            - DequeueCount 
            - DispatchCount
            - EnqueueCount 
            - ExpiredCount
            - InFlightCount
            - MemoryPercentUsage
            - ProducerCount 
            - QueueSize
        - query: "org.apache.activemq:Type=Topic,*"
          attributes:
            - ConsumerCount
            - AverageEnqueueTime
            - DequeueCount 
            - DispatchCount
            - EnqueueCount 
            - ExpiredCount
            - InFlightCount
            - MemoryPercentUsage
            - ProducerCount 
            - QueueSize
    zookeeper:
      pattern: "zookeeper"
      beans:
        - query: "org.apache.ZooKeeperService:name1=InMemoryDataTree,*"
          attributes:
            - NodeCount
            - WatchCount
    kafka:
      pattern: "kafka"
      beans:
        - query: '"kafka.server":type="BrokerTopicMetrics",*'
          attributes:
            - Count
        - query: '"kafka.server":type="DelayedFetchRequestMetrics",*'
          attributes:
            - Count
        - query: '"kafka.server":type="DelayedProducerRequestMetrics",*'
          attributes:
            - Count
        - query: '"kafka.server":type="FetchRequestPurgatory",*'
          attributes:
            - Value
        - query: '"kafka.server":type="ProducerRequestPurgatory",*'
          attributes:
            - Value
    hbase:
      pattern: "hbase"
      beans:
        - query: "Hadoop:service=HBase,name=MetricsSystem,sub=Stats"
          attributes:
            - DroppedPubAll
            - NumActiveSinks
            - NumActiveSources
            - NumAllSinks
            - NumAllSources
            - PublishNumOps
            - SnapshotNumOps
        - query: "Hadoop:service=HBase,name=RegionServer,sub=Server"
          attributes:
            - Append_num_ops
            - Delete_num_ops
            - FlushTime_num_ops
            - Get_num_ops
            - Increment_num_ops
            - Mutate_num_ops
            - Replay_num_ops
            - SplitTime_num_ops
            - blockCacheCount
            - blockCacheEvictionCount
            - blockCacheExpressHitPercent
            - blockCacheFreeSize
            - blockCacheHitCount
            - blockCacheMissCount
            - compactedCellsCount
            - compactedCellsSize
            - compactionQueueLength
            - flushQueueLength
            - flushedCellsCount
            - readRequestCount
            - slowAppendCount
            - slowDeleteCount
            - slowGetCount
            - slowIncrementCount
            - slowPutCount
        - query: "Hadoop:service=HBase,name=UgiMetrics"
          attributes:
            - LoginFailureNumOps
            - LoginSuccessNumOps
        - query: "Hadoop:service=HBase,name=Master,sub=Balancer"
          attributes:
            - BalancerCluster_num_ops
        - query: "Hadoop:service=HBase,name=Master,sub=AssignmentManger"
          attributes:
            - Assign_num_ops
            - BulkAssign_num_ops
    elasticsearch:
      pattern: "elasticsearch"
